# Initialize agent
agent = UnifiedTradingAgent(optimize_for_sharpe=True)

# Training parameters
stock_names = ['AAPL', 'MSFT', 'TSLA', 'GOOG', 'NVDA']
train_start_date = datetime.now() - timedelta(days=365*2)  # 2 years of training data
train_end_date = datetime.now() - timedelta(days=30)  # Up to last month

# Environment parameters
env_params = {
    'initial_balance': 10000,
    'transaction_cost': 0.001,
    'use_position_profit': True,
    'use_holding_bonus': True,
    'use_trading_penalty': True
}

# PPO parameters 
ppo_params = {
    'learning_rate': 3e-4,
    'n_steps': 1024,
    'batch_size': 256,
    'n_epochs': 10,
    'gamma': 0.99,
    'gae_lambda': 0.95,
    'clip_range': 0.2,
    'ent_coef': 0.01,
    'vf_coef': 0.5,
    'max_grad_norm': 0.5,
    'target_kl': 0.03
}

# Train the agent
metrics = agent.train(
    stock_names=stock_names,
    start_date=train_start_date,
    end_date=train_end_date, 
    env_params=env_params,
    ppo_params=ppo_params
)

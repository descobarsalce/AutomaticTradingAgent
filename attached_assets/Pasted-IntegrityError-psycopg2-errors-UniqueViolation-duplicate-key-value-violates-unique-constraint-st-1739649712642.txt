IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "stock_data_pkey" DETAIL: Key (id)=(1) already exists. [SQL: INSERT INTO stock_data (id, symbol, date, open, high, low, close, volume, last_updated) VALUES (%(id__0)s, %(symbol__0)s, %(date__0)s, %(open__0)s, %(high__0)s, %(low__0)s, %(close__0)s, %(volume__0)s, %(last_updated__0)s), (%(id__1)s, %(symbol__1)s, ... 145753 characters truncated ... %(open__999)s, %(high__999)s, %(low__999)s, %(close__999)s, %(volume__999)s, %(last_updated__999)s)] [parameters: {'last_updated__0': '2025-02-11 05:13:17.672775', 'id__0': 1, 'high__0': 193.81052306910513, 'open__0': 193.5020367748159, 'symbol__0': 'AAPL', 'date__0': '2023-12-06 00:00:00.000000', 'close__0': 191.38243103027344, 'low__0': 191.1734481168898, 'volume__0': 41089700.0, 'last_updated__1': '2025-02-11 05:13:17.672941', 'id__1': 2, 'high__1': 194.04935869024033, 'open__1': 192.6860424138352, 'symbol__1': 'AAPL', 'date__1': '2023-12-07 00:00:00.000000', 'close__1': 193.3229217529297, 'low__1': 192.64622891391613, 'volume__1': 47477700.0, 'last_updated__2': '2025-02-11 05:13:17.673107', 'id__2': 3, 'high__2': 195.03452363413496, 'open__2': 193.25324166018223, 'symbol__2': 'AAPL', 'date__2': '2023-12-08 00:00:00.000000', 'close__2': 194.75588989257812, 'low__2': 192.72582670763535, 'volume__2': 53377300.0, 'last_updated__3': '2025-02-11 05:13:17.673273', 'id__3': 4, 'high__3': 192.54670640437527, 'open__3': 192.16855411471755, 'symbol__3': 'AAPL', 'date__3': '2023-12-11 00:00:00.000000', 'close__3': 192.2382049560547, 'low__3': 190.48679074363935, 'volume__3': 60943700.0, 'last_updated__4': '2025-02-11 05:13:17.673438', 'id__4': 5, 'high__4': 193.77071848752672, 'open__4': 192.13871428631938, 'symbol__4': 'AAPL', 'date__4': '2023-12-12 00:00:00.000000', 'close__4': 193.76077270507812, 'low__4': 190.7853438376791, 'volume__4': 52696900.0, 'last_updated__5': '2025-02-11 05:13:17.673605', 'id__5': 6, 'high__5': 197.03471713546693, 'open__5': 194.13890022421998, 'symbol__5': 'AAPL' ... 8900 parameters truncated ... 'symbol__994': 'AAPL', 'date__994': '2022-10-21 00:00:00.000000', 'close__994': 145.49609375, 'low__994': 140.93173275802604, 'volume__994': 86548600.0, 'last_updated__995': '2025-02-11 05:13:17.618252', 'id__995': 996, 'high__995': 148.42042950536802, 'open__995': 145.4170538676587, 'symbol__995': 'AAPL', 'date__995': '2022-10-24 00:00:00.000000', 'close__995': 147.6498260498047, 'low__995': 144.24138536942965, 'volume__995': 75981900.0, 'last_updated__996': '2025-02-11 05:13:17.618753', 'id__996': 997, 'high__996': 150.65320712247134, 'open__996': 148.28210696285174, 'symbol__996': 'AAPL', 'date__996': '2022-10-25 00:00:00.000000', 'close__996': 150.5050048828125, 'low__996': 147.56090430315092, 'volume__996': 74732300.0, 'last_updated__997': '2025-02-11 05:13:17.619005', 'id__997': 998, 'high__997': 150.15920940047252, 'open__997': 149.14161747473483, 'symbol__997': 'AAPL', 'date__997': '2022-10-26 00:00:00.000000', 'close__997': 147.55101013183594, 'low__997': 146.2567770779952, 'volume__997': 88194300.0, 'last_updated__998': '2025-02-11 05:13:17.619223', 'id__998': 999, 'high__998': 147.25462333513107, 'open__998': 146.2864321323527, 'symbol__998': 'AAPL', 'date__998': '2022-10-27 00:00:00.000000', 'close__998': 143.05581665039062, 'low__998': 142.39388893497147, 'volume__998': 109180200.0, 'last_updated__999': '2025-02-11 05:13:17.619424', 'id__999': 1000, 'high__999': 155.6028541694243, 'open__999': 146.41487309870763, 'symbol__999': 'AAPL', 'date__999': '2022-10-28 00:00:00.000000', 'close__999': 153.8640594482422, 'low__999': 146.0394605904358, 'volume__999': 164762400.0}] (Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback:
File "/nix/store/rv55xcjw63fcfb8p9qd85s8hfxjry3w5-python3.11-streamlit-1.34.0/lib/python3.11/site-packages/streamlit/runtime/scriptrunner/script_runner.py", line 600, in _run_script
    exec(code, module.__dict__)
File "/home/runner/workspace/main.py", line 3, in <module>
    from core.base_agent import UnifiedTradingAgent
File "/home/runner/workspace/core/__init__.py", line 2, in <module>
    from .base_agent import UnifiedTradingAgent
File "/home/runner/workspace/core/base_agent.py", line 16, in <module>
    from environment import TradingEnv
File "/home/runner/workspace/environment/__init__.py", line 2, in <module>
    from .trading_env import TradingEnv
File "/home/runner/workspace/environment/trading_env.py", line 13, in <module>
    from data.data_handler import DataHandler
File "/home/runner/workspace/data/data_handler.py", line 14, in <module>
    from models.database import StockData
File "/home/runner/workspace/models/__init__.py", line 2, in <module>
    from .database import StockData
File "/home/runner/workspace/models/database.py", line 55, in <module>
    migrate_sqlite_to_postgres()
File "/home/runner/workspace/models/database.py", line 50, in migrate_sqlite_to_postgres
    pg_conn.execute(table.insert(), data)
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           ^^^^^
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)